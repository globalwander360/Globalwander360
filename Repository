@Override
@PreAuthorize("hasOpsPermission(branchCode, null, 'ReadTransactionProperties')")
public ResponseEntity<List<String>> getTransactionPropertyIdsByType(
        String branchCode,
        String countryCode,
        String beppuid,
        String eventId,
        String afr,
        Boolean isLightWeight,
        String propertyType) {

    TransactionProperty transactionPropertyModel = null;

    if (eventId != null) {
        transactionPropertyModel = transactionPropertyService
                .getTransactionPropertyList(beppuid, eventId, afr, branchCode, countryCode, isLightWeight);
    }

    List<String> matchedPropertyIds = new ArrayList<>();

    if (transactionPropertyModel != null && transactionPropertyModel.getProperties() != null) {
        matchedPropertyIds = transactionPropertyModel.getProperties().stream()
            .filter(p -> propertyType.equalsIgnoreCase(p.getPropertyType()))
            .map(TransactionProperties::getPropertyId)
            .collect(Collectors.toList());
    }

    return new ResponseEntity<>(matchedPropertyIds, HttpStatus.OK);
}
