Perfect Harish! ✅ Tumhara use-case ab crystal clear hai.

✅ Final Method in TransactionPropertyServiceImpl.java:

@Override
public List<String> getPropertyNamesByEventIdAndType(
        String eventId, String propertyType) {

    // Step 1: Get all properties matching propertyType via repository
    List<TransactionProperties> matchingTypeProps = transactionPropertiesRepository
            .findByPropertyTypeIgnoreCase(propertyType);

    if (matchingTypeProps.isEmpty()) {
        return Collections.emptyList();
    }

    // Step 2: Create Map of propertyId -> propertyName using dpwEventHelper
    Map<String, String> propertyIdToNameMap = new HashMap<>();
    for (TransactionProperties prop : matchingTypeProps) {
        TransactionProperties fullProp = dpwEventHelper.getTransactionPropertiesFromRef(prop.getId());
        if (fullProp != null && fullProp.getPropertyName() != null) {
            propertyIdToNameMap.put(prop.getId(), fullProp.getPropertyName());
        }
    }

    // Step 3: Get all properties for the given eventId
    List<TransactionProperties> eventProperties = transactionPropertiesRepository
            .findByEventId(eventId);

    if (eventProperties.isEmpty()) {
        return Collections.emptyList();
    }

    // Step 4: Match event's properties with map and collect names
    List<String> propertyNames = eventProperties.stream()
            .map(TransactionProperties::getId)
            .filter(propertyIdToNameMap::containsKey)
            .map(propertyIdToNameMap::get)
            .filter(Objects::nonNull)
            .distinct()
            .collect(Collectors.toList());

    return propertyNames;
}


---

✅ Repository Interface:

List<TransactionProperties> findByEventId(String eventId);
List<TransactionProperties> findByPropertyTypeIgnoreCase(String propertyType);


---

✅ Controller Layer:

@GetMapping("/property-names")
@PreAuthorize("hasOpsPermission(branchCode, null, 'ReadTransactionProperties')")
public ResponseEntity<List<String>> getPropertyNamesByTypeAndEvent(
        @RequestHeader("bnppuid") String bnppuid,
        @RequestHeader("branchCode") String branchCode,
        @RequestHeader("countryCode") String countryCode,
        @RequestParam("eventId") String eventId,
        @RequestParam("propertyType") String propertyType) {

    if (StringUtils.isAnyBlank(bnppuid, branchCode, countryCode, eventId, propertyType)) {
        throw new BadRequestException("Missing required headers or parameters");
    }

    List<String> names = transactionPropertyService
            .getPropertyNamesByEventIdAndType(eventId, propertyType);

    return ResponseEntity.ok(names);
}


---

✅ Sample Output:

[
  "Completion Motive",
  "Rejection Reason",
  "Transaction Reason"
]


---

✅ OpenAPI Spec Snippet (YAML):

paths:
  /transaction-properties/property-names:
    get:
      summary: Get Property Names by Event ID and Type
      description: Returns property names linked to an event and filtered by propertyType.
      operationId: getPropertyNamesByTypeAndEvent
      parameters:
        - name: bnppuid
          in: header
          required: true
          schema: { type: string }
        - name: branchCode
          in: header
          required: true
          schema: { type: string }
        - name: countryCode
          in: header
          required: true
          schema: { type: string }
        - name: eventId
          in: query
          required: true
          schema: { type: string }
        - name: propertyType
          in: query
          required: true
          schema: { type: string }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { type: string }

